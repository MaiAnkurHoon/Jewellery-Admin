(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{9552:function(e,r,s){Promise.resolve().then(s.bind(s,1639))},1639:function(e,r,s){"use strict";s.d(r,{default:function(){return B}});var n=s(7437),l=s(3464),t=s(7571),a=s(2869),d=s(7413),i=s(6512),c=s(1229),o=s(9501),u=s(3590),h=s(2265),x=s(8642),p=s(5186),j=s(9064),m=s(9376),f=s(6303),v=s(8360),b=s(865),g=s(3647),y=s(8575),w=s(3966),N=s(6741),C=s(886),k=s(6718),I=s(420),Z=s(1599),z=s(6840),S="Checkbox",[E,P]=(0,w.b)(S),[V,_]=E(S),R=h.forwardRef((e,r)=>{let{__scopeCheckbox:s,name:l,checked:t,defaultChecked:a,required:d,disabled:i,value:c="on",onCheckedChange:o,form:u,...x}=e,[p,j]=h.useState(null),m=(0,y.e)(r,e=>j(e)),f=h.useRef(!1),v=!p||u||!!p.closest("form"),[b=!1,g]=(0,C.T)({prop:t,defaultProp:a,onChange:o}),w=h.useRef(b);return h.useEffect(()=>{let e=null==p?void 0:p.form;if(e){let r=()=>g(w.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[p,g]),(0,n.jsxs)(V,{scope:s,state:b,disabled:i,children:[(0,n.jsx)(z.WV.button,{type:"button",role:"checkbox","aria-checked":J(b)?"mixed":b,"aria-required":d,"data-state":G(b),"data-disabled":i?"":void 0,disabled:i,value:c,...x,ref:m,onKeyDown:(0,N.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,N.M)(e.onClick,e=>{g(e=>!!J(e)||!e),v&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})}),v&&(0,n.jsx)(F,{control:p,bubbles:!f.current,name:l,value:c,checked:b,required:d,disabled:i,form:u,style:{transform:"translateX(-100%)"},defaultChecked:!J(a)&&a})]})});R.displayName=S;var W="CheckboxIndicator",X=h.forwardRef((e,r)=>{let{__scopeCheckbox:s,forceMount:l,...t}=e,a=_(W,s);return(0,n.jsx)(Z.z,{present:l||J(a.state)||!0===a.state,children:(0,n.jsx)(z.WV.span,{"data-state":G(a.state),"data-disabled":a.disabled?"":void 0,...t,ref:r,style:{pointerEvents:"none",...e.style}})})});X.displayName=W;var F=e=>{let{control:r,checked:s,bubbles:l=!0,defaultChecked:t,...a}=e,d=h.useRef(null),i=(0,k.D)(s),c=(0,I.t)(r);h.useEffect(()=>{let e=d.current,r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(i!==s&&r){let n=new Event("click",{bubbles:l});e.indeterminate=J(s),r.call(e,!J(s)&&s),e.dispatchEvent(n)}},[i,s,l]);let o=h.useRef(!J(s)&&s);return(0,n.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=t?t:o.current,...a,tabIndex:-1,ref:d,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function J(e){return"indeterminate"===e}function G(e){return J(e)?"indeterminate":e?"checked":"unchecked"}var O=s(653),A=s(4508);let D=h.forwardRef((e,r)=>{let{className:s,...l}=e;return(0,n.jsx)(R,{ref:r,className:(0,A.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...l,children:(0,n.jsx)(X,{className:(0,A.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(O.nQG,{className:"h-4 w-4"})})})});D.displayName=R.displayName;let Q=c.Ry({name:c.Z_().min(1),images:c.Ry({url:c.Z_().url()}).array(),price:c.oQ.number().min(1),categoryId:c.Z_().min(1),colorId:c.Z_().min(1),sizeId:c.Z_().min(1),isFeatured:c.O7().default(!1).optional(),isArchived:c.O7().default(!1).optional()});var B=e=>{let{initialData:r,categories:s,colors:c,sizes:y}=e,[w,N]=(0,h.useState)(!1),[C,k]=(0,h.useState)(!1),I=(0,m.useParams)(),Z=(0,m.useRouter)();(0,v.N)(),console.log(I);let z=r?"Edit product":"New product",S=r?"Edit a product":"Add a new product",E=r?"Save Changes":"Create",P=(0,o.cI)({resolver:(0,u.F)(Q),defaultValues:r?{...r,price:parseFloat(String(null==r?void 0:r.price))}:{name:"",images:[],price:0,categoryId:"",colorId:"",sizeId:"",isFeatured:!1,isArchived:!1}}),V=async e=>{try{k(!0),r?await l.Z.patch("/api/".concat(I.storeId,"/products/").concat(I.productId),e):await l.Z.post("/api/".concat(I.storeId,"/products"),e),Z.refresh(),j.ZP.success("Store update")}catch(e){j.ZP.error("Something went wrong")}finally{k(!1)}},_=async()=>{try{k(!0),await l.Z.delete("/api/".concat(I.storeId,"/products/").concat(I.productId)),Z.refresh(),Z.push("/".concat(I.storeId,"/products")),j.ZP.success("product deleted")}catch(e){j.ZP.error("Something went wrong")}finally{k(!1),N(!1)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.V,{isOpen:w,onClose:()=>N(!1),onConfirm:_,loading:C}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(t.Z,{title:z,description:S}),r&&(0,n.jsx)(a.z,{disabled:C,variant:"destructive",size:"sm",onClick:()=>N(!0),children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(i.Z,{}),(0,n.jsx)(x.l0,{...P,children:(0,n.jsxs)("form",{onSubmit:P.handleSubmit(V),className:"space-y-8 w-full",children:[(0,n.jsx)(x.Wi,{control:P.control,name:"images",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Images"}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(b.Z,{value:r.value.map(e=>e.url),disabled:C,onChange:e=>r.onChange([...r.value,{url:e}]),onRemove:e=>r.onChange([...r.value.filter(r=>r.url!==e)])})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-8",children:[(0,n.jsx)(x.Wi,{control:P.control,name:"name",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Name"}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(p.I,{disabled:C,placeholder:"Product Name",...r})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"price",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Price"}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(p.I,{type:"number",disabled:C,placeholder:"9.999999",...r})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"categoryId",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Billboard"}),(0,n.jsxs)(g.Ph,{disabled:C,onValueChange:r.onChange,value:r.value,defaultValue:r.value,children:[(0,n.jsx)(x.NI,{children:(0,n.jsx)(g.i4,{children:(0,n.jsx)(g.ki,{defaultValue:r.value,placeholder:"Select a Category"})})}),(0,n.jsx)(g.Bw,{children:s.map(e=>(0,n.jsx)(g.Ql,{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"sizeId",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Size"}),(0,n.jsxs)(g.Ph,{disabled:C,onValueChange:r.onChange,value:r.value,defaultValue:r.value,children:[(0,n.jsx)(x.NI,{children:(0,n.jsx)(g.i4,{children:(0,n.jsx)(g.ki,{defaultValue:r.value,placeholder:"Select a size"})})}),(0,n.jsx)(g.Bw,{children:y.map(e=>(0,n.jsx)(g.Ql,{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"colorId",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{children:"Color"}),(0,n.jsxs)(g.Ph,{disabled:C,onValueChange:r.onChange,value:r.value,defaultValue:r.value,children:[(0,n.jsx)(x.NI,{children:(0,n.jsx)(g.i4,{children:(0,n.jsx)(g.ki,{defaultValue:r.value,placeholder:"Select a size"})})}),(0,n.jsx)(g.Bw,{children:c.map(e=>(0,n.jsx)(g.Ql,{value:e.id,children:e.value},e.id))})]}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"isFeatured",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,n.jsx)(x.NI,{children:(0,n.jsx)(D,{checked:r.value,onCheckedChange:r.onChange})}),(0,n.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,n.jsx)(x.lX,{children:"Featured"}),(0,n.jsx)(x.pf,{children:"This product will be displayed on the home page"})]})]})}}),(0,n.jsx)(x.Wi,{control:P.control,name:"isArchived",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,n.jsx)(x.NI,{children:(0,n.jsx)(D,{checked:r.value,onCheckedChange:r.onChange})}),(0,n.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,n.jsx)(x.lX,{children:"Archieved"}),(0,n.jsx)(x.pf,{children:"This product will not be displayed on the home page"})]})]})}})]}),(0,n.jsx)(a.z,{disabled:C,className:"ml-auto",children:E})]})}),(0,n.jsx)(i.Z,{})]})}},865:function(e,r,s){"use strict";var n=s(7437),l=s(2265),t=s(2869),a=s(7413),d=s(332),i=s(3145),c=s(772);r.Z=e=>{let{onChange:r,onRemove:s,value:o,disabled:u}=e,[h,x]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{x(!0)},[]),h)?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-4 flex items-center gap-4",children:o.map(e=>(0,n.jsxs)("div",{className:"relative w-[200px] h-[200px] rounded-md overflow-hidden",children:[(0,n.jsx)("div",{className:"z-10 absolute top-2 right-2",children:(0,n.jsx)(t.z,{type:"button",onClick:()=>s(e),variant:"destructive",size:"icon",children:(0,n.jsx)(a.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(i.default,{fill:!0,className:"object-cover",alt:"Image",src:e})]},e))}),(0,n.jsx)(c.ZF,{onSuccess:e=>{r(e.info.secure_url)},uploadPreset:"ml_default",children:e=>{let{open:r}=e;return(0,n.jsxs)(t.z,{type:"button",onClick:()=>{r()},disabled:u,variant:"secondary",children:[(0,n.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Upload an Image"]})}})]}):null}}},function(e){e.O(0,[310,676,707,516,668,654,518,911,732,971,117,744],function(){return e(e.s=9552)}),_N_E=e.O()}]);